<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malik Service - One Stop Service Semarang</title>
  
  <!-- PWA -->
  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#2563eb">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Malik Service">
  <meta name="mobile-web-app-capable" content="yes">
  
  <!-- Cloudflare Turnstile -->
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <!-- CryptoJS untuk SHA-256 - TAMBAHKAN INI -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%232563eb' width='32' height='32' rx='6'/%3E%3Cpath fill='white' d='M16 6c-5.5 0-10 4.5-10 10s4.5 10 10 10 10-4.5 10-10S21.5 6 16 6zm0 16c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6z'/%3E%3C/svg%3E">
  
  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "LocalBusiness",
    "name": "Malik Service",
    "description": "Servis HP & Laptop profesional di Semarang",
    "url": "https://malik-service.pages.dev",
    "telephone": "+6285713087659",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Jl. Untung Suropati Ds.Jamalsari Rt004/Rw002 No.52",
      "addressLocality": "Kedungpane",
      "addressRegion": "Semarang",
      "postalCode": "50211"
    }
  }
  </script>
  
  <style>
    /* ========== RESET & VARIABLES ========== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      --primary: #2563eb;
      --primary-dark: #1e40af;
      --primary-light: #dbeafe;
      --accent: #25D366;
      --accent-dark: #20b85a;
      --warning: #fbbf24;
      --text-dark: #0f172a;
      --text-muted: #64748b;
      --text-light: #94a3b8;
      --bg-light: #f1f5f9;
      --bg-card: #ffffff;
      --border-color: #e2e8f0;
      --shadow-sm: 0 2px 6px rgba(0,0,0,0.04);
      --shadow-md: 0 10px 25px -10px rgba(0,0,0,0.1);
      --shadow-lg: 0 25px 60px -15px rgba(0,20,60,0.3);
      --radius-sm: 16px;
      --radius-md: 24px;
      --radius-lg: 32px;
      --radius-xl: 48px;
      --transition: 0.2s ease;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      min-height: 100dvh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px 16px;
      position: relative;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 300px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      z-index: 0;
      clip-path: polygon(0 0, 100% 0, 100% 70%, 0 100%);
      pointer-events: none;
    }
    
    .container {
      max-width: 800px;
      width: 100%;
      margin: 0 auto;
      position: relative;
      z-index: 10;
    }
    
    /* ========== LOGIN TOGGLE & MODAL ========== */
    .login-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      gap: 8px;
    }
    
    .login-toggle button {
      padding: 12px 24px;
      border: none;
      border-radius: 40px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      background: white;
      color: var(--text-dark);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    .login-toggle button.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    .login-toggle button i {
      margin-right: 8px;
    }
    
    .login-modal {
      display: none;
      position: fixed;
      top: 80px;
      right: 20px;
      width: 350px;
      background: white;
      border-radius: var(--radius-lg);
      padding: 28px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
      z-index: 999;
      border: 1px solid var(--border-color);
      animation: slideDown 0.3s ease;
    }
    
    .login-modal.active {
      display: block;
    }
    
    .login-header {
      text-align: center;
      margin-bottom: 24px;
    }
    
    .login-header i {
      font-size: 56px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 12px;
    }
    
    .login-header h3 {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-dark);
      margin-bottom: 4px;
    }
    
    .input-group {
      margin-bottom: 20px;
    }
    
    .input-group label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: var(--text-muted);
      margin-bottom: 8px;
    }
    
    .input-group label i {
      margin-right: 6px;
      color: var(--primary);
    }
    
    .input-group input {
      width: 100%;
      padding: 14px 18px;
      border: 2px solid var(--border-color);
      border-radius: var(--radius-md);
      font-size: 15px;
      transition: all 0.3s;
    }
    
    .input-group input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(37,99,235,0.1);
    }
    
    .login-btn {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: var(--radius-md);
      color: white;
      font-weight: 700;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s;
      margin: 20px 0 16px;
    }
    
    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px -5px rgba(102, 126, 234, 0.5);
    }
    
    /* ========== MAIN CARD ========== */
    .card {
      background: rgba(255, 255, 255, 0.98);
      border-radius: var(--radius-xl);
      overflow: hidden;
      box-shadow: var(--shadow-lg);
      border: 1px solid rgba(255,255,255,0.5);
    }
    
    /* ========== HEADER ========== */
    .header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      padding: 30px 28px 40px;
      color: white;
      position: relative;
      overflow: hidden;
    }
    
    .header::before,
    .header::after {
      content: '';
      position: absolute;
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      border-radius: 50%;
      pointer-events: none;
    }
    
    .header::before { top: -30%; right: -10%; }
    .header::after { bottom: -30%; left: -10%; }
    
    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      position: relative;
      z-index: 2;
      flex-wrap: wrap;
      gap: 12px;
    }
    
    .logo h1 {
      font-size: 28px;
      font-weight: 800;
      letter-spacing: -0.5px;
      margin-bottom: 4px;
    }
    
    .logo span {
      font-size: 13px;
      opacity: 0.9;
      display: block;
    }
    
    .badge {
      background: rgba(255,255,255,0.2);
      padding: 12px 20px;
      border-radius: 40px;
      font-weight: 600;
      font-size: 14px;
      border: 1px solid rgba(255,255,255,0.3);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .badge i {
      font-size: 16px;
    }
    
    .info-toko {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      background: rgba(255,255,255,0.1);
      border-radius: var(--radius-lg);
      padding: 22px 25px;
      border: 1px solid rgba(255,255,255,0.2);
      position: relative;
      z-index: 2;
    }
    
    .info-item {
      display: flex;
      align-items: center;
      gap: 14px;
      flex: 1 1 200px;
    }
    
    .info-item i {
      width: 22px;
      height: 22px;
      font-size: 22px;
      flex-shrink: 0;
    }
    
    .info-text {
      font-size: 14px;
      opacity: 0.9;
      line-height: 1.5;
    }
    
    /* ========== CONTENT ========== */
    .content {
      padding: 30px 28px 35px;
    }
    
    /* Form Section */
    .form-section {
      background: var(--bg-light);
      border-radius: var(--radius-lg);
      padding: 24px;
      margin-bottom: 24px;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-sm);
    }
    
    .section-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      font-size: 18px;
      color: var(--text-dark);
      margin-bottom: 20px;
    }
    
    .section-title i {
      color: var(--primary);
    }
    
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
    }
    
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 14px 18px;
      border: 1.5px solid var(--border-color);
      border-radius: var(--radius-md);
      font-size: 15px;
      font-family: inherit;
      background: white;
      transition: all var(--transition);
    }
    
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(37,99,235,0.1);
    }
    
    /* Pickup Card */
    .pickup-card {
      background: linear-gradient(115deg, #eef2ff 0%, var(--primary-light) 100%);
      border-radius: 28px;
      padding: 22px 24px;
      margin-bottom: 24px;
      border: 1px solid #bfdbfe;
      box-shadow: 0 6px 14px rgba(37,99,235,0.08);
    }
    
    .pickup-header {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      font-size: 18px;
      color: var(--primary-dark);
      margin-bottom: 18px;
    }
    
    .pickup-options {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    
    .pickup-options label {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 24px;
      background: white;
      border-radius: 40px;
      font-weight: 600;
      cursor: pointer;
      border: 1.5px solid #bfdbfe;
      transition: all var(--transition);
    }
    
    .pickup-options input[type="radio"] {
      accent-color: var(--primary);
      width: 18px;
      height: 18px;
    }
    
    /* Filter Card */
    .filter-card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 24px;
      margin-bottom: 24px;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow-md);
    }
    
    .filter-item {
      margin-bottom: 20px;
    }
    
    .filter-item label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      font-size: 14px;
      color: #334155;
      margin-bottom: 10px;
    }
    
    .filter-item label i {
      color: var(--primary);
    }
    
    .filter-item select {
      width: 100%;
      padding: 16px 20px;
      border: 1.5px solid var(--border-color);
      border-radius: 30px;
      font-size: 15px;
      background: #fafcff;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%232563eb' stroke-width='2.5'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 20px center;
      cursor: pointer;
    }
    
    #itemSelect {
      min-height: 200px;
      height: auto;
      padding: 8px;
      background-image: none;
      appearance: auto;
    }
    
    #itemSelect option {
      padding: 10px 14px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .stats-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--bg-light);
      padding: 10px 20px;
      border-radius: 40px;
      font-size: 13px;
      font-weight: 600;
      margin-top: 15px;
      border: 1px solid var(--border-color);
    }
    
    /* Detail Card */
    .detail-card {
      background: linear-gradient(145deg, var(--bg-card) 0%, #fafcff 100%);
      border-radius: 36px;
      padding: 28px;
      margin-bottom: 24px;
      border: 2px solid var(--border-color);
      box-shadow: 0 15px 30px -15px rgba(0,0,0,0.12);
      position: relative;
      overflow: hidden;
    }
    
    .detail-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px 20px;
    }
    
    .detail-item.full-width {
      grid-column: 1 / -1;
    }
    
    .detail-label {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 4px;
    }
    
    .detail-label i {
      color: var(--primary);
    }
    
    .detail-value {
      font-weight: 700;
      color: var(--text-dark);
      background: var(--bg-light);
      padding: 10px 16px;
      border-radius: var(--radius-sm);
      font-size: 15px;
      border: 1px solid var(--border-color);
    }
    
    .detail-value.harga {
      font-size: 24px;
      font-weight: 800;
      color: var(--primary);
      background: var(--primary-light);
      border-color: #93c5fd;
    }
    
    .detail-value.estimasi {
      background: #fef9c3;
      color: #854d0e;
    }
    
    /* Total Card */
    .total-card {
      background: linear-gradient(135deg, #1e293b 0%, var(--text-dark) 100%);
      border-radius: 28px;
      padding: 24px 28px;
      margin-bottom: 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: white;
      box-shadow: 0 15px 30px -10px rgba(15,23,42,0.5);
      flex-wrap: wrap;
      gap: 16px;
    }
    
    .total-label {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 20px;
      font-weight: 600;
    }
    
    .total-label i {
      color: var(--warning);
    }
    
    .total-value {
      font-size: 28px;
      font-weight: 800;
      background: rgba(255,255,255,0.1);
      padding: 12px 28px;
      border-radius: 40px;
    }
    
    /* WA Button */
    .wa-button {
      width: 100%;
      background: linear-gradient(115deg, var(--accent) 0%, var(--accent-dark) 100%);
      border: none;
      border-radius: 40px;
      padding: 22px 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      font-weight: 700;
      font-size: 20px;
      color: white;
      box-shadow: 0 20px 35px -8px rgba(37, 211, 102, 0.4);
      cursor: pointer;
      transition: all var(--transition);
      margin-bottom: 18px;
    }
    
    .wa-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 25px 45px -8px rgba(37, 211, 102, 0.5);
    }
    
    .wa-button i {
      font-size: 28px;
    }
    
    /* Footer */
    .footer-note {
      text-align: center;
      font-size: 13px;
      color: var(--text-light);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    /* ========== ADMIN DASHBOARD ========== */
    .admin-dashboard {
      background: white;
      border-radius: var(--radius-xl);
      padding: 28px;
      box-shadow: var(--shadow-lg);
    }
    
    .admin-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .admin-header h2 {
      font-size: 24px;
      color: var(--text-dark);
    }
    
    .admin-header h2 i {
      color: var(--primary);
      margin-right: 10px;
    }
    
    .user-info {
      background: var(--bg-light);
      padding: 10px 20px;
      border-radius: 40px;
      font-weight: 600;
    }
    
    .user-info i {
      color: var(--primary);
      margin-right: 8px;
    }
    
    .logout-btn {
      background: #ef4444;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 40px;
      font-weight: 600;
      cursor: pointer;
      margin-left: 12px;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }
    
    .stat-card {
      background: var(--bg-light);
      padding: 20px;
      border-radius: var(--radius-md);
    }
    
    .stat-card i {
      font-size: 28px;
      color: var(--primary);
      margin-bottom: 12px;
    }
    
    .stat-card .stat-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-dark);
    }
    
    .admin-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 24px;
      border-bottom: 2px solid var(--border-color);
      padding-bottom: 8px;
      flex-wrap: wrap;
    }
    
    .admin-tab {
      padding: 12px 24px;
      cursor: pointer;
      border-radius: 40px;
      font-weight: 600;
      transition: all var(--transition);
    }
    
    .admin-tab.active {
      background: var(--primary);
      color: white;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    th {
      background: var(--bg-light);
      padding: 12px;
      text-align: left;
      font-weight: 600;
    }
    
    td {
      padding: 12px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .status-success {
      color: #22c55e;
      font-weight: 600;
    }
    
    .status-failed {
      color: #ef4444;
      font-weight: 600;
    }
    
    /* Tombol Cetak */
    .print-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      cursor: pointer;
      margin-right: 4px;
    }
    
    .print-btn i {
      margin-right: 4px;
    }
    
    .action-cell {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
    }
    
    /* Floating WA */
    .floating-wa {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 28px;
      box-shadow: 0 8px 24px rgba(37, 211, 102, 0.4);
      cursor: pointer;
      z-index: 1000;
      border: none;
    }
    
    /* Install Prompt */
    .install-prompt {
      position: fixed;
      bottom: 100px;
      right: 24px;
      background: white;
      padding: 16px 20px;
      border-radius: var(--radius-md);
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      display: flex;
      align-items: center;
      gap: 12px;
      z-index: 1001;
      opacity: 0;
      visibility: hidden;
      transform: translateY(20px);
      transition: all 0.3s ease;
      border: 1px solid var(--border-color);
      max-width: 280px;
    }
    
    .install-prompt.visible {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }
    
    .install-prompt-icon {
      width: 40px;
      height: 40px;
      background: var(--primary-light);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .install-prompt-icon i {
      font-size: 24px;
      color: var(--primary);
    }
    
    .install-prompt-content {
      flex: 1;
    }
    
    .install-prompt-title {
      font-weight: 700;
      font-size: 14px;
      color: var(--text-dark);
    }
    
    .install-prompt-desc {
      font-size: 12px;
      color: var(--text-muted);
    }
    
    .install-prompt-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
    }
    
    .install-prompt-close {
      background: none;
      border: none;
      padding: 4px;
      cursor: pointer;
      color: var(--text-muted);
    }
    
    /* Modal Cetak */
    .print-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }
    
    .print-modal.active {
      display: flex;
    }
    
    .print-modal-content {
      background: white;
      border-radius: var(--radius-lg);
      padding: 28px;
      max-width: 400px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .print-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .print-modal-header h3 {
      font-size: 20px;
      color: var(--text-dark);
    }
    
    .close-print-modal {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--text-muted);
    }
    
    .print-preview {
      font-family: 'Courier New', monospace;
      background: #f8fafc;
      padding: 20px;
      border-radius: var(--radius-md);
      margin: 20px 0;
      border: 1px dashed var(--primary);
    }
    
    .print-preview .header {
      background: none;
      color: var(--text-dark);
      padding: 0 0 10px 0;
      text-align: center;
    }
    
    .print-preview .header h4 {
      font-size: 18px;
      margin-bottom: 4px;
    }
    
    .print-preview hr {
      border: 1px dashed var(--border-color);
      margin: 10px 0;
    }
    
    .print-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 6px;
      font-size: 14px;
    }
    
    .print-total {
      font-size: 18px;
      font-weight: 700;
      margin-top: 10px;
      text-align: right;
    }
    
    .print-actions {
      display: flex;
      gap: 12px;
      margin-top: 20px;
    }
    
    .print-actions button {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: var(--radius-md);
      font-weight: 600;
      cursor: pointer;
    }
    
    .btn-print {
      background: var(--primary);
      color: white;
    }
    
    .btn-cancel {
      background: var(--bg-light);
      color: var(--text-dark);
    }
    
    /* Animations */
    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Responsive */
    @media (max-width: 640px) {
      body { padding: 12px; }
      .login-toggle { top: 10px; right: 10px; }
      .login-toggle button { padding: 8px 16px; font-size: 13px; }
      .login-modal { width: 300px; right: 10px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Login Toggle Buttons -->
    <div class="login-toggle">
      <button id="userModeBtn" class="active">
        <i class="fas fa-home"></i> Layanan Servis
      </button>
      <button id="adminToggleBtn">
        <i class="fas fa-user-lock"></i> Admin / Kasir
      </button>
    </div>
    
    <!-- Login Modal -->
    <div class="login-modal" id="loginModal">
      <div class="login-header">
        <i class="fas fa-store"></i>
        <h3>Login Malik Service</h3>
        <p style="color: var(--text-muted);">Akses khusus petugas</p>
      </div>
      
      <div class="input-group">
        <label><i class="fas fa-user"></i> Username</label>
        <input type="text" id="username" placeholder="Masukkan username">
      </div>
      
      <div class="input-group">
        <label><i class="fas fa-lock"></i> Password</label>
        <input type="password" id="password" placeholder="••••••••">
      </div>
      
      <!-- Cloudflare Turnstile -->
      <div class="cf-turnstile" data-sitekey="0x4AAAAAAChNwxuVixGlxwEf"></div>
      
      <button class="login-btn" id="loginBtn">
        <i class="fas fa-sign-in-alt"></i> Login
      </button>
      
      <div style="margin-top: 16px; text-align: center; font-size: 12px; color: var(--text-muted);">
        <i class="fas fa-shield-alt"></i> Area terbatas - hanya untuk petugas
      </div>
    </div>
    
    <!-- ========== PUBLIC MODE (LANDING PAGE) ========== -->
    <div id="publicMode">
      <div class="card">
        <!-- Header -->
        <div class="header">
          <div class="header-top">
            <div class="logo">
              <h1>Malik Service</h1>
              <span>One Stop Service SEMARANG</span>
            </div>
            <div class="badge">
              <i class="fas fa-motorcycle"></i>
              <span>Pickup 7km - Rp25rb</span>
            </div>
          </div>
          
          <div class="info-toko">
            <div class="info-item">
              <i class="fas fa-map-marker-alt"></i>
              <div class="info-text">
                Jl. Untung Suropati Ds.Jamalsari Rt004/Rw002 No.52, Kedungpane 50211
              </div>
            </div>
            <div class="info-item">
              <i class="fas fa-phone-alt"></i>
              <div class="info-text">
                0857-1308-7659 (WA)<br>
                thumbtackid@gmail.com
              </div>
            </div>
          </div>
        </div>
        
        <!-- Content -->
        <div class="content" id="order">
          <!-- Form Data Pelanggan -->
          <div class="form-section">
            <div class="section-title">
              <i class="fas fa-user"></i>
              <span>Data Pelanggan</span>
            </div>
            
            <div class="form-grid">
              <div class="form-group">
                <input type="text" id="namaPelanggan" placeholder="Nama Lengkap">
              </div>
              <div class="form-group">
                <input type="tel" id="noHpPelanggan" placeholder="No. HP">
              </div>
              <div class="form-group">
                <input type="text" id="alamatPelanggan" placeholder="Alamat">
              </div>
            </div>
          </div>
          
          <!-- Pickup Options -->
          <div class="pickup-card">
            <div class="pickup-header">
              <i class="fas fa-truck"></i>
              <span>Layanan Pick-up dan Antar (max 7km)</span>
            </div>
            
            <div class="pickup-options">
              <label>
                <input type="radio" name="pickupOption" value="ya" checked>
                <i class="fas fa-check-circle"></i>
                <span>Ya, pickup dan antar (+Rp25.000)</span>
              </label>
              <label>
                <input type="radio" name="pickupOption" value="tidak">
                <i class="fas fa-home"></i>
                <span>Saya datang ke toko</span>
              </label>
            </div>
          </div>
          
          <!-- Filter Kategori -->
          <div class="filter-card">
            <div class="filter-item">
              <label><i class="fas fa-mobile-alt"></i> Pilih Kategori</label>
              <select id="kategoriSelect">
                <option value="all">SEMUA KATEGORI</option>
                <option value="Android">ANDROID</option>
                <option value="Laptop">LAPTOP</option>
              </select>
            </div>
            
            <div class="filter-item">
              <label><i class="fas fa-tools"></i> Pilih Tipe Masalah</label>
              <select id="tipeSelect">
                <option value="all">SEMUA TIPE</option>
              </select>
            </div>
            
            <div class="filter-item">
              <label><i class="fas fa-list"></i> Pilih Item Servis</label>
              <select id="itemSelect" size="8"></select>
            </div>
            
            <div class="stats-badge">
              <i class="fas fa-database"></i>
              <span id="totalItems">Memuat layanan...</span>
            </div>
          </div>
          
          <!-- Detail Servis -->
          <div class="detail-card">
            <div class="detail-grid">
              <div class="detail-item">
                <span class="detail-label"><i class="fas fa-tag"></i> Kategori</span>
                <span class="detail-value" id="displayKategori">-</span>
              </div>
              <div class="detail-item">
                <span class="detail-label"><i class="fas fa-cog"></i> Tipe</span>
                <span class="detail-value" id="displayTipe">-</span>
              </div>
              <div class="detail-item full-width">
                <span class="detail-label"><i class="fas fa-box"></i> Item</span>
                <span class="detail-value" id="displayItem">-</span>
              </div>
              <div class="detail-item">
                <span class="detail-label"><i class="fas fa-dollar-sign"></i> Jenis</span>
                <span class="detail-value" id="displayJenis">-</span>
              </div>
              <div class="detail-item">
                <span class="detail-label"><i class="fas fa-money-bill"></i> Harga</span>
                <span class="detail-value harga" id="displayHarga">-</span>
              </div>
              <div class="detail-item">
                <span class="detail-label"><i class="fas fa-clock"></i> Estimasi</span>
                <span class="detail-value estimasi" id="displayEstimasi">-</span>
              </div>
            </div>
          </div>
          
          <!-- Total -->
          <div class="total-card">
            <div class="total-label">
              <i class="fas fa-money-bill"></i>
              <span>Total Biaya</span>
            </div>
            <div class="total-value" id="totalNominal">Rp 0</div>
          </div>
          
          <!-- Tombol WA -->
          <button class="wa-button" id="waButton">
            <i class="fab fa-whatsapp"></i>
            <span>Pesan via WhatsApp</span>
            <i class="fas fa-arrow-right"></i>
          </button>
          
          <div class="footer-note">
            <i class="fas fa-heart" style="color: #ef4444;"></i>
            <span>Klik tombol di atas untuk mengirim pesan ke 0857-1308-7659</span>
            <i class="fas fa-heart" style="color: #ef4444;"></i>
          </div>
        </div>
      </div>
    </div>
    
    <!-- ========== ADMIN MODE (SETELAH LOGIN) ========== -->
    <div id="adminMode" style="display: none;">
      <div class="admin-dashboard">
        <div class="admin-header">
          <h2><i class="fas fa-store"></i> Malik Kasir</h2>
          <div>
            <span class="user-info" id="userDisplay">
              <i class="fas fa-user-circle"></i> <span id="userName">Admin</span> (<span id="userRole">admin</span>)
            </span>
            <button class="logout-btn" id="logoutBtn">
              <i class="fas fa-sign-out-alt"></i> Logout
            </button>
          </div>
        </div>
        
        <!-- Stats -->
        <div class="stats-grid">
          <div class="stat-card">
            <i class="fas fa-shopping-cart"></i>
            <div class="stat-value" id="totalTransaksi">0</div>
            <div style="color: var(--text-muted);">Total Transaksi</div>
          </div>
          <div class="stat-card">
            <i class="fas fa-money-bill-wave"></i>
            <div class="stat-value" id="totalPendapatan">Rp 0</div>
            <div style="color: var(--text-muted);">Pendapatan</div>
          </div>
          <div class="stat-card">
            <i class="fas fa-users"></i>
            <div class="stat-value" id="totalLogin">0</div>
            <div style="color: var(--text-muted);">Aktivitas Login</div>
          </div>
        </div>
        
        <!-- Tabs -->
        <div class="admin-tabs">
          <div class="admin-tab active" data-tab="transaksi">Transaksi</div>
          <div class="admin-tab" data-tab="laporan">Laporan</div>
          <div class="admin-tab" data-tab="loginLog" id="loginLogTab">Log Login</div>
          <div class="admin-tab" data-tab="users" id="usersTab">Manajemen User</div>
        </div>
        
        <!-- Tab: Transaksi (DENGAN TOMBOL CETAK) -->
        <div class="tab-content active" id="tab-transaksi">
          <button id="tambahTransaksiBtn" style="margin-bottom: 16px; padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer;">
            <i class="fas fa-plus"></i> Transaksi Baru
          </button>
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>Tanggal</th>
                <th>Item</th>
                <th>Total</th>
                <th>Kasir</th>
                <th>Aksi</th>
              </tr>
            </thead>
            <tbody id="transaksiTable">
              <tr><td colspan="6" style="text-align: center;">Belum ada transaksi</td></tr>
            </tbody>
          </table>
        </div>
        
        <!-- Tab: Laporan -->
        <div class="tab-content" id="tab-laporan">
          <table>
            <thead>
              <tr><th>Bulan</th><th>Pendapatan</th><th>Pengeluaran</th><th>Laba</th></tr>
            </thead>
            <tbody id="laporanTable">
              <tr><td colspan="4" style="text-align: center;">Belum ada data</td></tr>
            </tbody>
          </table>
        </div>
        
        <!-- Tab: Log Login -->
        <div class="tab-content" id="tab-loginLog">
          <table>
            <thead>
              <tr><th>Waktu</th><th>Username</th><th>Role</th><th>IP</th><th>Status</th></tr>
            </thead>
            <tbody id="loginLogTable">
              <tr><td colspan="5" style="text-align: center;">Memuat log login...</td></tr>
            </tbody>
          </table>
        </div>
        
        <!-- Tab: Manajemen User -->
        <div class="tab-content" id="tab-users">
          <table>
            <thead>
              <tr><th>Username</th><th>Role</th><th>Nama</th><th>Terdaftar</th><th>Last Login</th><th>Aksi</th></tr>
            </thead>
            <tbody id="usersTable">
              <tr><td colspan="6" style="text-align: center;">Memuat data user...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Modal Tambah Transaksi -->
  <div class="print-modal" id="tambahTransaksiModal">
    <div class="print-modal-content">
      <div class="print-modal-header">
        <h3><i class="fas fa-plus-circle"></i> Transaksi Baru</h3>
        <button class="close-print-modal" id="closeTambahModal">&times;</button>
      </div>
      <div style="padding: 10px 0;">
        <div style="margin-bottom: 15px;">
          <label style="display: block; margin-bottom: 5px; font-weight: 600;">Nama Pelanggan</label>
          <input type="text" id="transNama" placeholder="Nama pelanggan" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-color);">
        </div>
        <div style="margin-bottom: 15px;">
          <label style="display: block; margin-bottom: 5px; font-weight: 600;">Item Servis</label>
          <input type="text" id="transItem" placeholder="Contoh: LCD Pecah" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-color);">
        </div>
        <div style="margin-bottom: 15px;">
          <label style="display: block; margin-bottom: 5px; font-weight: 600;">Harga</label>
          <input type="number" id="transHarga" placeholder="0" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-color);">
        </div>
        <div style="margin-bottom: 20px;">
          <label style="display: block; margin-bottom: 5px; font-weight: 600;">Pickup?</label>
          <select id="transPickup" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border-color);">
            <option value="tidak">Tidak (0)</option>
            <option value="ya">Ya (+Rp25.000)</option>
          </select>
        </div>
        <div class="print-actions">
          <button class="btn-cancel" id="batalTambah">Batal</button>
          <button class="btn-print" id="simpanTransaksiBtn">Simpan & Cetak</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Modal Cetak Resi -->
  <div class="print-modal" id="printResiModal">
    <div class="print-modal-content">
      <div class="print-modal-header">
        <h3><i class="fas fa-print"></i> Cetak Resi</h3>
        <button class="close-print-modal" id="closePrintModal">&times;</button>
      </div>
      <div id="printPreviewContent" class="print-preview"></div>
      <div class="print-actions">
        <button class="btn-cancel" id="cancelPrint">Tutup</button>
        <button class="btn-print" id="doPrintBtn"><i class="fas fa-print"></i> Cetak</button>
      </div>
    </div>
  </div>
  
  <!-- Floating WA Button -->
  <button class="floating-wa" id="floatingWa">
    <i class="fab fa-whatsapp"></i>
  </button>
  
  <!-- Install Prompt -->
  <div class="install-prompt" id="installPrompt">
    <div class="install-prompt-icon">
      <i class="fas fa-download"></i>
    </div>
    <div class="install-prompt-content">
      <div class="install-prompt-title">Instal Aplikasi</div>
      <div class="install-prompt-desc">Akses lebih cepat dari home screen</div>
    </div>
    <button class="install-prompt-btn" id="installBtn">Instal</button>
    <button class="install-prompt-close" id="installClose">
      <i class="fas fa-times"></i>
    </button>
  </div>
  
  <script>
    // ============================================
    // DATA LAYANAN LENGKAP - 400+ ITEM
    // ============================================
    const serviceDB = [
      // ========== ANDROID - LAYAR ==========
      { kategori: 'Android', tipe: 'Layar', nama: 'LCD Pecah - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Layar', nama: 'LCD Pecah - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Layar', nama: 'LCD Pecah - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Layar', nama: 'LCD Bergaris - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Layar', nama: 'LCD Bergaris - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Layar', nama: 'LCD Bergaris - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Layar', nama: 'Touch Error - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Layar', nama: 'Touch Error - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Layar', nama: 'Touch Error - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Layar', nama: 'Layar Blank - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Layar', nama: 'Layar Blank - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Layar', nama: 'Layar Blank - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      
      // ========== ANDROID - POWER ==========
      { kategori: 'Android', tipe: 'Power', nama: 'Mati Total - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Power', nama: 'Mati Total - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Power', nama: 'Mati Total - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Power', nama: 'Restart Sendiri - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Power', nama: 'Restart Sendiri - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Power', nama: 'Restart Sendiri - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Power', nama: 'Tombol Power Rusak - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Power', nama: 'Tombol Power Rusak - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Power', nama: 'Tombol Power Rusak - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      
      // ========== ANDROID - BATERAI ==========
      { kategori: 'Android', tipe: 'Baterai', nama: 'Baterai Drop - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Baterai', nama: 'Baterai Drop - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Baterai', nama: 'Baterai Drop - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Baterai', nama: 'Tidak Bisa Cas - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Baterai', nama: 'Tidak Bisa Cas - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Baterai', nama: 'Tidak Bisa Cas - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Baterai', nama: 'Konektor Charger Rusak - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Baterai', nama: 'Konektor Charger Rusak - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Baterai', nama: 'Konektor Charger Rusak - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      
      // ========== ANDROID - AUDIO ==========
      { kategori: 'Android', tipe: 'Audio', nama: 'Speaker Pecah - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Audio', nama: 'Speaker Pecah - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Audio', nama: 'Speaker Pecah - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Audio', nama: 'Mic Tidak Berfungsi - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Audio', nama: 'Mic Tidak Berfungsi - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Audio', nama: 'Mic Tidak Berfungsi - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Audio', nama: 'Headset Tidak Terdeteksi - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Audio', nama: 'Headset Tidak Terdeteksi - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Audio', nama: 'Headset Tidak Terdeteksi - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      
      // ========== ANDROID - KAMERA ==========
      { kategori: 'Android', tipe: 'Kamera', nama: 'Kamera Blur - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Kamera', nama: 'Kamera Blur - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Kamera', nama: 'Kamera Blur - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Kamera', nama: 'Kamera Mati - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Kamera', nama: 'Kamera Mati - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Kamera', nama: 'Kamera Mati - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      
      // ========== ANDROID - SINYAL ==========
      { kategori: 'Android', tipe: 'Sinyal', nama: 'No Service - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Sinyal', nama: 'No Service - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Sinyal', nama: 'No Service - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Sinyal', nama: 'IMEI Hilang - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Sinyal', nama: 'IMEI Hilang - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Sinyal', nama: 'IMEI Hilang - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Sinyal', nama: 'Antena Rusak - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Sinyal', nama: 'Antena Rusak - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Sinyal', nama: 'Antena Rusak - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      
      // ========== ANDROID - SOFTWARE ==========
      { kategori: 'Android', tipe: 'Software', nama: 'Bootloop - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Software', nama: 'Bootloop - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Software', nama: 'Bootloop - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Software', nama: 'Stuck Logo - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Software', nama: 'Stuck Logo - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Software', nama: 'Stuck Logo - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Software', nama: 'Lupa Pola / Password - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Software', nama: 'Lupa Pola / Password - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Software', nama: 'Lupa Pola / Password - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Software', nama: 'Flashing Ulang - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Software', nama: 'Flashing Ulang - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Software', nama: 'Flashing Ulang - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Software', nama: 'Virus / Iklan - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Software', nama: 'Virus / Iklan - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Software', nama: 'Virus / Iklan - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      
      // ========== ANDROID - MAINBOARD ==========
      { kategori: 'Android', tipe: 'Mainboard', nama: 'IC Power - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Mainboard', nama: 'IC Power - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Mainboard', nama: 'IC Power - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Mainboard', nama: 'IC Charging - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Mainboard', nama: 'IC Charging - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Mainboard', nama: 'IC Charging - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Mainboard', nama: 'Short Mesin - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Mainboard', nama: 'Short Mesin - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Mainboard', nama: 'Short Mesin - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      { kategori: 'Android', tipe: 'Mainboard', nama: 'Kena Air - Sparepart Ori', jenis: 'Sparepart', harga: 350000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Mainboard', nama: 'Kena Air - Sparepart KW', jenis: 'Sparepart', harga: 220000, estimasi: '1-2 Jam' },
      { kategori: 'Android', tipe: 'Mainboard', nama: 'Kena Air - Jasa Servis', jenis: 'Jasa', harga: 120000, estimasi: '30-90 Menit' },
      
      // ========== LAPTOP - LAYAR ==========
      { kategori: 'Laptop', tipe: 'Layar', nama: 'LCD Pecah - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Layar', nama: 'LCD Pecah - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Layar', nama: 'LCD Pecah - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Layar', nama: 'LCD Bergaris - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Layar', nama: 'LCD Bergaris - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Layar', nama: 'LCD Bergaris - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Layar', nama: 'LCD Blank - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Layar', nama: 'LCD Blank - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Layar', nama: 'LCD Blank - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      
      // ========== LAPTOP - CASING ==========
      { kategori: 'Laptop', tipe: 'Casing', nama: 'Engsel Laptop Rusak - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Casing', nama: 'Engsel Laptop Rusak - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Casing', nama: 'Engsel Laptop Rusak - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Casing', nama: 'Frame Retak - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Casing', nama: 'Frame Retak - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Casing', nama: 'Frame Retak - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Casing', nama: 'Cover LCD Pecah - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Casing', nama: 'Cover LCD Pecah - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Casing', nama: 'Cover LCD Pecah - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      
      // ========== LAPTOP - KEYBOARD ==========
      { kategori: 'Laptop', tipe: 'Keyboard', nama: 'Keyboard Mati - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Keyboard', nama: 'Keyboard Mati - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Keyboard', nama: 'Keyboard Mati - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Keyboard', nama: 'Tombol Keyboard Rusak - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Keyboard', nama: 'Tombol Keyboard Rusak - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Keyboard', nama: 'Tombol Keyboard Rusak - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      
      // ========== LAPTOP - TOUCHPAD ==========
      { kategori: 'Laptop', tipe: 'Touchpad', nama: 'Touchpad Tidak Berfungsi - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Touchpad', nama: 'Touchpad Tidak Berfungsi - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Touchpad', nama: 'Touchpad Tidak Berfungsi - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      
      // ========== LAPTOP - POWER ==========
      { kategori: 'Laptop', tipe: 'Power', nama: 'Laptop Mati Total - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Power', nama: 'Laptop Mati Total - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Power', nama: 'Laptop Mati Total - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Power', nama: 'Tidak Bisa Charge - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Power', nama: 'Tidak Bisa Charge - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Power', nama: 'Tidak Bisa Charge - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Power', nama: 'DC Jack Rusak - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Power', nama: 'DC Jack Rusak - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Power', nama: 'DC Jack Rusak - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      
      // ========== LAPTOP - BATERAI ==========
      { kategori: 'Laptop', tipe: 'Baterai', nama: 'Baterai Drop - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Baterai', nama: 'Baterai Drop - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Baterai', nama: 'Baterai Drop - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Baterai', nama: 'Baterai Tidak Terdeteksi - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Baterai', nama: 'Baterai Tidak Terdeteksi - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Baterai', nama: 'Baterai Tidak Terdeteksi - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      
      // ========== LAPTOP - COOLING ==========
      { kategori: 'Laptop', tipe: 'Cooling', nama: 'Fan Berisik - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Cooling', nama: 'Fan Berisik - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Cooling', nama: 'Fan Berisik - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Cooling', nama: 'Overheat - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Cooling', nama: 'Overheat - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Cooling', nama: 'Overheat - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      
      // ========== LAPTOP - STORAGE ==========
      { kategori: 'Laptop', tipe: 'Storage', nama: 'HDD Bad Sector - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Storage', nama: 'HDD Bad Sector - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Storage', nama: 'HDD Bad Sector - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Storage', nama: 'Upgrade SSD - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Storage', nama: 'Upgrade SSD - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Storage', nama: 'Upgrade SSD - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Storage', nama: 'SSD Tidak Terdeteksi - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Storage', nama: 'SSD Tidak Terdeteksi - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Storage', nama: 'SSD Tidak Terdeteksi - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      
      // ========== LAPTOP - RAM ==========
      { kategori: 'Laptop', tipe: 'RAM', nama: 'RAM Error - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'RAM', nama: 'RAM Error - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'RAM', nama: 'RAM Error - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'RAM', nama: 'Upgrade RAM - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'RAM', nama: 'Upgrade RAM - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'RAM', nama: 'Upgrade RAM - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      
      // ========== LAPTOP - MAINBOARD ==========
      { kategori: 'Laptop', tipe: 'Mainboard', nama: 'IC Power - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Mainboard', nama: 'IC Power - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Mainboard', nama: 'IC Power - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Mainboard', nama: 'Short Circuit - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Mainboard', nama: 'Short Circuit - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Mainboard', nama: 'Short Circuit - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      
      // ========== LAPTOP - SOFTWARE ==========
      { kategori: 'Laptop', tipe: 'Software', nama: 'Install Windows - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Software', nama: 'Install Windows - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Software', nama: 'Install Windows - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Software', nama: 'Windows Blue Screen - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Software', nama: 'Windows Blue Screen - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Software', nama: 'Windows Blue Screen - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'Software', nama: 'Laptop Lemot - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Software', nama: 'Laptop Lemot - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'Software', nama: 'Laptop Lemot - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      
      // ========== LAPTOP - BIOS ==========
      { kategori: 'Laptop', tipe: 'BIOS', nama: 'BIOS Corrupt - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'BIOS', nama: 'BIOS Corrupt - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'BIOS', nama: 'BIOS Corrupt - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' },
      { kategori: 'Laptop', tipe: 'BIOS', nama: 'Update BIOS - Sparepart Ori', jenis: 'Sparepart', harga: 850000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'BIOS', nama: 'Update BIOS - Sparepart Universal', jenis: 'Sparepart', harga: 550000, estimasi: '2-4 Jam' },
      { kategori: 'Laptop', tipe: 'BIOS', nama: 'Update BIOS - Jasa Servis', jenis: 'Jasa', harga: 180000, estimasi: '1-3 Jam' }
    ];
    
    // ============================================
    // STATE MANAGEMENT
    // ============================================
    let currentUser = null;
    let filteredItems = [];
    let currentItem = null;
    let loginLogs = [];
    let transactions = [];
    let deferredPrompt = null;
    let loginAttempts = 0;
    let lastLoginAttempt = 0;
    const MAX_ATTEMPTS = 3;
    const LOCKOUT_TIME = 30000; // 30 detik
    
    // AKUN HANYA DI SINI - TIDAK DITAMPILKAN DI HTML
    const users = [
      { id: 1, username: 'admin', password: '240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9', role: 'admin', name: 'Administrator', created: '2024-01-01' },
      { id: 2, username: 'kasir', password: 'f02b7c1e519e4fa436147f7e1399974f9510aa9c8e0cb8be29151eb540f9d214', role: 'kasir', name: 'Kasir Toko', created: '2024-01-01' }
    ];
    
    // ============================================
    // UTILITY FUNCTIONS
    // ============================================
    function formatRupiah(angka) {
      if (!angka) return 'Rp 0';
      return 'Rp ' + angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');
    }
    
    function getFilteredItems(kategori, tipe) {
      let result = serviceDB;
      if (kategori !== 'all') {
        result = result.filter(item => item.kategori === kategori);
      }
      if (tipe !== 'all') {
        result = result.filter(item => item.tipe === tipe);
      }
      return result.sort((a, b) => a.nama.localeCompare(b.nama));
    }
    
    function getUniqueTipe(kategori) {
      const filtered = kategori === 'all' ? serviceDB : serviceDB.filter(item => item.kategori === kategori);
      return [...new Set(filtered.map(item => item.tipe))].sort();
    }
    
    // ============================================
    // RENDER FUNCTIONS
    // ============================================
    function renderTipeOptions() {
      const kategori = document.getElementById('kategoriSelect').value;
      const tipeList = getUniqueTipe(kategori);
      const tipeSelect = document.getElementById('tipeSelect');
      
      tipeSelect.innerHTML = '<option value="all">SEMUA TIPE</option>';
      tipeList.forEach(tipe => {
        const option = document.createElement('option');
        option.value = tipe;
        option.textContent = tipe;
        tipeSelect.appendChild(option);
      });
    }
    
    function renderItemOptions() {
      const kategori = document.getElementById('kategoriSelect').value;
      const tipe = document.getElementById('tipeSelect').value;
      filteredItems = getFilteredItems(kategori, tipe);
      
      const itemSelect = document.getElementById('itemSelect');
      itemSelect.innerHTML = '';
      
      if (filteredItems.length === 0) {
        const option = document.createElement('option');
        option.textContent = 'Tidak ada item';
        itemSelect.appendChild(option);
      } else {
        filteredItems.forEach((item, index) => {
          const option = document.createElement('option');
          option.value = index;
          option.textContent = `${item.nama} - ${item.jenis} - ${formatRupiah(item.harga)}`;
          itemSelect.appendChild(option);
        });
      }
      
      document.getElementById('totalItems').textContent = `${filteredItems.length} layanan & sparepart`;
      
      if (filteredItems.length > 0) {
        itemSelect.value = 0;
        updateDetail(filteredItems[0]);
      }
    }
    
    function updateDetail(item) {
      if (!item) return;
      
      document.getElementById('displayKategori').textContent = item.kategori;
      document.getElementById('displayTipe').textContent = item.tipe;
      document.getElementById('displayItem').textContent = item.nama;
      document.getElementById('displayJenis').textContent = item.jenis;
      document.getElementById('displayHarga').textContent = formatRupiah(item.harga);
      document.getElementById('displayEstimasi').textContent = item.estimasi;
      
      const pickupYa = document.querySelector('input[name="pickupOption"][value="ya"]').checked;
      const total = item.harga + (pickupYa ? 25000 : 0);
      document.getElementById('totalNominal').textContent = formatRupiah(total);
    }
    
    function loadAdminData() {
      document.getElementById('totalTransaksi').textContent = transactions.length;
      
      const totalPendapatan = transactions.reduce((sum, t) => sum + (t.total || 0), 0);
      document.getElementById('totalPendapatan').textContent = formatRupiah(totalPendapatan);
      
      document.getElementById('totalLogin').textContent = loginLogs.length;
      
      // Log Login Table
      let logHtml = '';
      if (loginLogs.length === 0) {
        logHtml = '<tr><td colspan="5" style="text-align: center;">Belum ada log login</td></tr>';
      } else {
        loginLogs.slice(0, 20).forEach(log => {
          logHtml += `<tr>
            <td>${log.waktu}</td>
            <td>${log.username}</td>
            <td>${log.role}</td>
            <td>${log.ip}</td>
            <td class="${log.status === 'Sukses' ? 'status-success' : 'status-failed'}">${log.status}</td>
          </tr>`;
        });
      }
      document.getElementById('loginLogTable').innerHTML = logHtml;
      
      // Users Table
      let usersHtml = '';
      users.forEach(u => {
        usersHtml += `<tr>
          <td>${u.username}</td>
          <td>${u.role}</td>
          <td>${u.name}</td>
          <td>${u.created}</td>
          <td>${u.lastLogin || '-'}</td>
          <td>
            <i class="fas fa-edit" style="color: var(--primary); cursor: pointer; margin-right: 8px;" onclick="alert('Edit user ${u.username}')"></i>
            <i class="fas fa-trash" style="color: #ef4444; cursor: pointer;" onclick="alert('Hapus user ${u.username}')"></i>
          </td>
        </tr>`;
      });
      document.getElementById('usersTable').innerHTML = usersHtml;
      
      // Transaksi Table dengan tombol cetak
      let transaksiHtml = '';
      if (transactions.length === 0) {
        transaksiHtml = '<tr><td colspan="6" style="text-align: center;">Belum ada transaksi</td></tr>';
      } else {
        transactions.slice(0, 20).forEach((t, index) => {
          transaksiHtml += `<tr>
            <td>${t.id || index+1}</td>
            <td>${t.tanggal || new Date().toLocaleString('id-ID')}</td>
            <td>${t.item || '-'}</td>
            <td>${formatRupiah(t.total || 0)}</td>
            <td>${t.kasir || currentUser?.name || 'Admin'}</td>
            <td class="action-cell">
              <button class="print-btn" onclick="previewPrint('${t.item || '-'}', ${t.total || 0}, '${t.nama || 'Pelanggan'}')">
                <i class="fas fa-print"></i> Cetak
              </button>
            </td>
          </tr>`;
        });
      }
      document.getElementById('transaksiTable').innerHTML = transaksiHtml;
    }
    
    // ============================================
    // FUNGSI CETAK RESI
    // ============================================
    function previewPrint(item, total, nama) {
      const modal = document.getElementById('printResiModal');
      const preview = document.getElementById('printPreviewContent');
      
      const tanggal = new Date().toLocaleString('id-ID');
      const kasir = currentUser?.name || 'Admin';
      const idTransaksi = 'TRX-' + Date.now().toString().slice(-8);
      
      preview.innerHTML = `
        <div style="text-align: center; margin-bottom: 15px;">
          <h4 style="font-size: 18px; margin-bottom: 4px;">MALIK SERVICE</h4>
          <p style="font-size: 12px;">One Stop Service Semarang</p>
          <p style="font-size: 11px;">Jl. Untung Suropati No.52, Kedungpane</p>
          <p style="font-size: 11px;">Telp: 0857-1308-7659</p>
        </div>
        <hr>
        <div style="margin: 10px 0;">
          <div class="print-row"><span>No. Resi:</span> <span>${idTransaksi}</span></div>
          <div class="print-row"><span>Tanggal:</span> <span>${tanggal}</span></div>
          <div class="print-row"><span>Kasir:</span> <span>${kasir}</span></div>
          <div class="print-row"><span>Pelanggan:</span> <span>${nama}</span></div>
        </div>
        <hr>
        <div style="margin: 10px 0;">
          <div class="print-row"><span>Item Servis:</span> <span>${item}</span></div>
        </div>
        <hr>
        <div class="print-total">
          Total: ${formatRupiah(total)}
        </div>
        <hr>
        <div style="text-align: center; margin-top: 15px; font-size: 11px;">
          <p>Terima kasih telah menggunakan layanan kami</p>
          <p>Barang yang sudah dibeli tidak dapat dikembalikan</p>
        </div>
      `;
      
      modal.classList.add('active');
    }
    
    function doPrint() {
      const printContent = document.getElementById('printPreviewContent').innerHTML;
      const printWindow = window.open('', '_blank');
      printWindow.document.write(`
        <html>
          <head>
            <title>Cetak Resi - Malik Service</title>
            <style>
              body { font-family: 'Courier New', monospace; padding: 20px; max-width: 300px; margin: 0 auto; }
              .print-row { display: flex; justify-content: space-between; margin-bottom: 5px; }
              hr { border: 1px dashed #000; }
              .print-total { font-size: 18px; font-weight: bold; text-align: right; margin-top: 10px; }
            </style>
          </head>
          <body>
            ${printContent}
          </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.focus();
      printWindow.print();
    }
    
    // ============================================
    // PWA INSTALL
    // ============================================
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      setTimeout(() => {
        if (deferredPrompt) {
          document.getElementById('installPrompt').classList.add('visible');
        }
      }, 5000);
    });
    
    document.getElementById('installBtn').addEventListener('click', async () => {
      if (!deferredPrompt) return;
      
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      
      if (outcome === 'accepted') {
        console.log('PWA installed');
      }
      
      deferredPrompt = null;
      document.getElementById('installPrompt').classList.remove('visible');
    });
    
    document.getElementById('installClose').addEventListener('click', () => {
      document.getElementById('installPrompt').classList.remove('visible');
    });
    
    // ============================================
    // EVENT LISTENERS
    // ============================================
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize
      renderTipeOptions();
      renderItemOptions();
      
      // Check session
      const savedUser = sessionStorage.getItem('currentUser');
      if (savedUser) {
        try {
          currentUser = JSON.parse(savedUser);
          document.getElementById('userName').textContent = currentUser.name;
          document.getElementById('userRole').textContent = currentUser.role;
          document.getElementById('publicMode').style.display = 'none';
          document.getElementById('adminMode').style.display = 'block';
          document.getElementById('adminToggleBtn').classList.add('active');
          document.getElementById('userModeBtn').classList.remove('active');
          loadAdminData();
        } catch (e) {}
      }
      
      // Category change
      document.getElementById('kategoriSelect').addEventListener('change', function() {
        renderTipeOptions();
        renderItemOptions();
      });
      
      // Type change
      document.getElementById('tipeSelect').addEventListener('change', renderItemOptions);
      
      // Item change
      document.getElementById('itemSelect').addEventListener('change', function() {
        const idx = parseInt(this.value);
        if (!isNaN(idx) && filteredItems[idx]) {
          currentItem = filteredItems[idx];
          updateDetail(currentItem);
        }
      });
      
      // Pickup change
      document.querySelectorAll('input[name="pickupOption"]').forEach(radio => {
        radio.addEventListener('change', function() {
          if (currentItem) updateDetail(currentItem);
        });
      });
      
      // WA Button
      document.getElementById('waButton').addEventListener('click', function() {
        const nama = document.getElementById('namaPelanggan').value;
        const noHp = document.getElementById('noHpPelanggan').value;
        const alamat = document.getElementById('alamatPelanggan').value;
        
        if (!currentItem) {
          alert('Silakan pilih layanan terlebih dahulu');
          return;
        }
        
        if (!nama || !noHp) {
          alert('Nama dan No HP wajib diisi');
          return;
        }
        
        const pickupYa = document.querySelector('input[name="pickupOption"][value="ya"]').checked;
        const total = currentItem.harga + (pickupYa ? 25000 : 0);
        
        const message = `Halo Malik Service, saya ingin servis:
        
Nama: ${nama}
No HP: ${noHp}
Alamat: ${alamat || '-'}

--- PESANAN ---
Kategori: ${currentItem.kategori}
Tipe: ${currentItem.tipe}
Item: ${currentItem.nama}
Jenis: ${currentItem.jenis}
Harga: ${formatRupiah(currentItem.harga)}
Estimasi: ${currentItem.estimasi}
Pickup: ${pickupYa ? 'Ya (+Rp25rb)' : 'Tidak'}
Total: ${formatRupiah(total)}

Mohon konfirmasi. Terima kasih.`;
        
        window.open(`https://wa.me/6285713087659?text=${encodeURIComponent(message)}`, '_blank');
      });
      
      // Floating WA
      document.getElementById('floatingWa').addEventListener('click', function() {
        window.open('https://wa.me/6285713087659', '_blank');
      });
      
      // ========== LOGIN FUNCTIONS ==========
      document.getElementById('userModeBtn').addEventListener('click', function() {
        this.classList.add('active');
        document.getElementById('adminToggleBtn').classList.remove('active');
        document.getElementById('publicMode').style.display = 'block';
        document.getElementById('adminMode').style.display = 'none';
        document.getElementById('loginModal').classList.remove('active');
      });
      
      document.getElementById('adminToggleBtn').addEventListener('click', function() {
        this.classList.add('active');
        document.getElementById('userModeBtn').classList.remove('active');
        
        if (currentUser) {
          document.getElementById('publicMode').style.display = 'none';
          document.getElementById('adminMode').style.display = 'block';
          document.getElementById('loginModal').classList.remove('active');
        } else {
          document.getElementById('loginModal').classList.toggle('active');
        }
      });
      
      document.getElementById('loginBtn').addEventListener('click', function() {
        const now = Date.now();
        
        // Reset attempts jika sudah lewat lockout time
        if (now - lastLoginAttempt > LOCKOUT_TIME) {
          loginAttempts = 0;
        }
        
        // Cek apakah sudah melebihi batas percobaan
        if (loginAttempts >= MAX_ATTEMPTS) {
          const waktuTunggu = Math.ceil((LOCKOUT_TIME - (now - lastLoginAttempt)) / 1000);
          if (waktuTunggu > 0) {
            alert(`Terlalu banyak percobaan gagal. Silakan tunggu ${waktuTunggu} detik.`);
            return;
          } else {
            loginAttempts = 0;
          }
        }
        
        // Verifikasi Turnstile
        const turnstileToken = document.querySelector('[name="cf-turnstile-response"]')?.value;
        if (!turnstileToken) {
          alert('Mohon verifikasi bahwa Anda bukan robot');
          return;
        }
        
        const username = document.getElementById('username').value;
const password = document.getElementById('password').value;

// Hash dulu password yang dimasukkan dengan SHA-256
const hashedPassword = CryptoJS.SHA256(password).toString();
console.log('Password hash:', hashedPassword); // Untuk cek di console

// Cari user dengan hash
const user = users.find(u => u.username === username && u.password === hashedPassword);
        
        if (user) {
          // Login sukses - reset attempts
          loginAttempts = 0;
          
          currentUser = { ...user, password: undefined };
          sessionStorage.setItem('currentUser', JSON.stringify(currentUser));
          
          // Catat login log
          const logEntry = {
            waktu: new Date().toLocaleString('id-ID'),
            username: user.username,
            role: user.role,
            ip: 'Client-side',
            status: 'Sukses'
          };
          loginLogs.unshift(logEntry);
          
          // Update last login
          user.lastLogin = new Date().toLocaleString('id-ID');
          
          // Update display
          document.getElementById('userName').textContent = user.name;
          document.getElementById('userRole').textContent = user.role;
          
          // Hide login modal, show admin mode
          document.getElementById('publicMode').style.display = 'none';
          document.getElementById('adminMode').style.display = 'block';
          document.getElementById('loginModal').classList.remove('active');
          
          // Load admin data
          loadAdminData();
          
          // Sembunyikan tab khusus admin jika role kasir
          if (user.role === 'kasir') {
            document.getElementById('loginLogTab').style.display = 'none';
            document.getElementById('usersTab').style.display = 'none';
          } else {
            document.getElementById('loginLogTab').style.display = 'block';
            document.getElementById('usersTab').style.display = 'block';
          }
        } else {
          // Login gagal
          loginAttempts++;
          lastLoginAttempt = now;
          
          alert('Username atau password salah');
          
          // Catat login gagal
          loginLogs.unshift({
            waktu: new Date().toLocaleString('id-ID'),
            username: username || 'unknown',
            role: '-',
            ip: 'Client-side',
            status: 'Gagal'
          });
        }
      });
      
      document.getElementById('logoutBtn').addEventListener('click', function() {
        currentUser = null;
        sessionStorage.removeItem('currentUser');
        document.getElementById('publicMode').style.display = 'block';
        document.getElementById('adminMode').style.display = 'none';
        document.getElementById('userModeBtn').classList.add('active');
        document.getElementById('adminToggleBtn').classList.remove('active');
      });
      
      // Tab switching
      document.querySelectorAll('.admin-tab').forEach(tab => {
        tab.addEventListener('click', function() {
          document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
          this.classList.add('active');
          
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          document.getElementById(`tab-${this.dataset.tab}`).classList.add('active');
        });
      });
      
      // Close modal when clicking outside
      window.addEventListener('click', function(e) {
        const modal = document.getElementById('loginModal');
        const toggleBtn = document.getElementById('adminToggleBtn');
        if (!modal.contains(e.target) && !toggleBtn.contains(e.target)) {
          modal.classList.remove('active');
        }
      });
      
      // Modal Transaksi
      document.getElementById('tambahTransaksiBtn').addEventListener('click', function() {
        document.getElementById('tambahTransaksiModal').classList.add('active');
      });
      
      document.getElementById('closeTambahModal').addEventListener('click', function() {
        document.getElementById('tambahTransaksiModal').classList.remove('active');
      });
      
      document.getElementById('batalTambah').addEventListener('click', function() {
        document.getElementById('tambahTransaksiModal').classList.remove('active');
      });
      
      document.getElementById('simpanTransaksiBtn').addEventListener('click', function() {
        const nama = document.getElementById('transNama').value;
        const item = document.getElementById('transItem').value;
        const harga = parseInt(document.getElementById('transHarga').value) || 0;
        const pickup = document.getElementById('transPickup').value;
        
        if (!nama || !item || !harga) {
          alert('Semua field harus diisi');
          return;
        }
        
        const total = harga + (pickup === 'ya' ? 25000 : 0);
        
        const newTrans = {
          id: 'TRX-' + Date.now().toString().slice(-6),
          tanggal: new Date().toLocaleString('id-ID'),
          item: item,
          total: total,
          kasir: currentUser?.name || 'Admin',
          nama: nama
        };
        
        transactions.unshift(newTrans);
        document.getElementById('tambahTransaksiModal').classList.remove('active');
        loadAdminData();
        
        // Preview cetak
        setTimeout(() => {
          previewPrint(item, total, nama);
        }, 200);
        
        // Reset form
        document.getElementById('transNama').value = '';
        document.getElementById('transItem').value = '';
        document.getElementById('transHarga').value = '';
      });
      
      // Modal Cetak
      document.getElementById('closePrintModal').addEventListener('click', function() {
        document.getElementById('printResiModal').classList.remove('active');
      });
      
      document.getElementById('cancelPrint').addEventListener('click', function() {
        document.getElementById('printResiModal').classList.remove('active');
      });
      
      document.getElementById('doPrintBtn').addEventListener('click', function() {
        doPrint();
        document.getElementById('printResiModal').classList.remove('active');
      });
    });
    
    // Expose fungsi untuk global
    window.previewPrint = previewPrint;
    
    // ============================================
    // REGISTER SERVICE WORKER
    // ============================================
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js')
          .then(reg => console.log('Service Worker registered'))
          .catch(err => console.log('Service Worker error:', err));
      });
    }
  </script>
</body>
</html>
